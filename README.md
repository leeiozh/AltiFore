# Altifore

Altimeter Forecaster - программа для расчета пролетов спутников для синхронизации времени судовых измерений.

## Установка

Сейчас все собирается руками:

```bash
git clone https://github.com/leeiozh/AltiFore.git
cd AltiFore
conda create -y --name alti_env python=3.11
conda install --force-reinstall -y -q --name alti_env -c conda-forge --file requirements.txt
conda activate alti_env
```

Альтернативно:

```bash
git clone https://github.com/leeiozh/AltiFore.git
cd AltiFore
python3 -m venv alti_env
source alti_env/bin/activate
pip install -r requirements.txt
```

Потом постараюсь собрать готовые бинарники.

## Обновление TLE

С регулярностью не реже 1 месяца необходимо обновлять данные телеметрии наших спутников. Чаще 3 дней обновлять
бесполезно. Обновление происходит после нажатия на кнопку "Update TLE!".

#### Возможные проблемы здесь:

1) Ошибка вида "Check your internet connection ..." означает, что нужно перепроверить доступ к интернету. Технически,
   даже если на машине доступ только через прокси, все должно работать.
2) Ошибка вида "Check links in tle_sites.txt ..." означает, что нужно глазами просмотреть запрашиваемый файл в папке tle
   на наличие опечаток.
3) Если интернет отвалился во время обновления TLE необходимо обязательно перезапустить программу.

Если ничего не помогает, нужно писать на ezhova.ea@phystech.edu. Я буду высылать или текстом, или файлом tle_data.txt
свежие данные. Их необходимо заменой помещать в папку tle, они занимают не больше 2 кБ.

## Запуск расчета из файла

Если есть маршрут, построенный с помощь OpenCPN, его можно ПКМ сохранить в формат .kml и подгрузить в программу после
нажатия на кнопку "Select file". Затем необходимо ввести предполагаемую скорость (в предположении равномерного
движения), дату и время нахождения в первой точке маршрута. Чем больше точек на маршруте, тем точнее расчет.

**Важно!** Расстояние между точками на маршруте стоит указывать не реже чем каждые 200 км. Это значение обуславливается
радиусом круга, в котором мы отслеживаем пролеты спутников. При приближении к суше данное значение рекомендуется
уменьшать вплоть до 50 км.

После введения параметров необходимо нажать "Calculate file!".

#### Возможные проблемы здесь:

1. Опечатки в скорости, дате или времени.
2. Предупреждение вида "No flights ..." означает, что вам не повезло и стоит попробовать ввести больше данных о времени
   и положении, чтобы убедиться, что программа работает корректно. Если есть подозрения, необходимо проверить файл
   tle_data.txt. Если подозрений нет, то завтра можно отдыхать.

## Запуск расчета по ручным данным

Для расчета на ближайшее время рекомендуется избирать этот вариант. Необходимо добавить строчки для ввода по нажатия
кнопки "Add new row". Рекомендуется добавлять новую строку после заполнения предыдущей для отработки автозаполнения. В
каждой строке необходимо ввести координаты и время точки, в которой вы планируете быть в ближайшее время. Рекомендуемое
количество точек на день от 4 до 7.

После введения параметров необходимо нажать "Calculate table!".

#### Возможные проблемы здесь:

1. Опечатки. Плюс в широте и долготе вводить не обязательно.
2. Данные ввода должны быть отсортированы по времени от настоящего к будущему.
3. Пустые строки необходимо удалять с помощью кнопки "Remove last row".

## Интерпретация результатов

По завершении расчета будет получено несколько файлов:

#### Интерактивная карта

Вверху находится панель управления. Внизу строка с текущим положением курсора. При наведении на интересующую точку
пролета отрисовывается голубой круг вокруг соответствующей точки положения судна. Внизу выводятся полные данные о
пролете: расстояние до судна, дата и время пролета, название спутника, его координаты.

#### Таблица text.xlsx с расписанием пролетов

Цвета соответствуют легенде на карте. Если вы видите, что время не отсортировано по возрастанию, следует
перепроверить время каждого пролета с помощью интерактивной карты. Вообще, сверять полученные результаты с картой полезно.

#### Текстовый файл test.txt с полным описанием каждого пролета

В нем записываются данные о ближайшей к треку судна точке пролета спутника.

#### Картинка test.png со скриншотом карты в домашнем положении

При составлении графика вахт нужно руководстоваться здравым смыслом. Близкие по времени точки можно объединять в одно
измерение. Очень далекие по расстоянию можно отбрасывать (особенно вблизи суши).

## Отслеживание высоты Солнца над горизонтом

При составлении графика вахт полезно сверяться с расписанием восходов и закатов. В правом верхнем углу есть ползунок с
рисунком Солнца. Слева от него можно ввести интересующую дату, координаты места и рассчитать высоты Солнца над
горизонтом в течение дня. Крайнему левому положения позунка соответствует 00:00, крайнему правому - 23:59. Управление
осуществляется с помощью стрелок на клавиатуре, микропоправки можно делать с помощью однократных ЛКМ рядом с ползунком.
